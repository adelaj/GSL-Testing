clone_depth: 1

for:
  -
    image: Visual Studio 2019
    
    environment:
        MSYSTEM: MINGW64
    
    install:
      - C:\msys64\usr\bin\bash.exe -lc 'pacman -Syu --noconfirm'
      - C:\msys64\usr\bin\bash.exe -lc 'pacman -Syu --noconfirm'
      - C:\msys64\usr\bin\bash.exe -lc 'pacman -S --noconfirm mingw-w64-x86_64-toolchain make'
    
    before_build:
      - git submodule foreach git pull origin master
    
    build_script:
      - ps: |
            $env:MSYS2_PATH=C:\msys64\usr\bin\bash.exe -c 'echo $PATH'
            $env:MSYS2_WD=C:\msys64\usr\bin\bash.exe -c 'pwd'
            C:\msys64\usr\bin\bash.exe -lc '\
            echo $MSYS2_WD/RegionsMT/Makefile; \
            cat $MSYS2_WD/RegionsMT/Makefile; \
            export PATH=\"$MSYS2_PATH:$PATH\" PREFIX=\"$MSYS2_WD\" MATRIX=\"msvc:x64:Debug\" && \
            mingw32-make -f $MSYS2_WD/RegionsMT/Makefile -j all\(gsl\) && \
            (mingw32-make -f RegionsMT/Makefile -j -k test\(gsl\) || true)'
